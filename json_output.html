<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Station Status Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
  h1 { text-align: center; }
  .upload-section { text-align: center; margin-bottom: 20px; }
  table { width: 100%; border-collapse: collapse; background: #fff; }
  th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
  th { background: #f0f0f0; }
  .status-ok { background: #d4edda; color: #155724; }
  .status-missing { background: #fff3cd; color: #856404; }
  .status-error { background: #f8d7da; color: #721c24; }
  .status-invalid { background: #e2e3e5; color: #383d41; }
  .action-input { width: 100%; padding: 5px; }
  .save-btn { padding: 5px 10px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
</style>
</head>
<body>
  <h1>Station Status Dashboard</h1>
  <div class="upload-section">
    <input type="file" id="fileInput" accept="application/json">
  </div>
  <table id="statusTable" style="display:none;">
    <thead>
      <tr>
        <th>Station</th>
        <th>Date</th>
        <th>Time</th>
        <th>Status</th>
        <th>Product</th>
        <th>Error</th>
        <th>Action Taken</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
<script>
  const fileInput = document.getElementById('fileInput');
  const table = document.getElementById('statusTable');
  const tbody = table.querySelector('tbody');

  fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (event) => {
        try {
          const json = JSON.parse(event.target.result);
          renderTable(json);
        } catch (err) {
          alert('Invalid JSON file');
        }
      };
      reader.readAsText(file);
    }
  });

  function renderTable(data) {
    tbody.innerHTML = '';
    data.forEach(item => {
      const tr = document.createElement('tr');
      tr.className = `status-${item.status}`;

      tr.innerHTML = `
        <td>${item.station.toUpperCase()}</td>
        <td>${item.date}</td>
        <td>${item.time}</td>
        <td>${item.status}</td>
        <td>${item.product_type}</td>
        <td>${item.error_message || ''}</td>
        <td>
          <input class="action-input" placeholder="Enter action taken">
          <button class="save-btn" onclick="saveAction(this)">Save</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
    table.style.display = 'table';
  }

  function saveAction(button) {
    const row = button.closest('tr');
    const station = row.children[0].textContent;
    const action = row.querySelector('.action-input').value;
    alert(`Action saved for ${station}: ${action}`);
    // Here you can send the action to your backend (AJAX / fetch API)
  }
</script>
</body>
</html>
